<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Flappy Chim Viá»‡t Nam</title>
<style>
  body {
    margin: 0;
    background: linear-gradient(#5dade2, #aed6f1);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: Arial, sans-serif;
  }
  canvas {
    background: linear-gradient(#87ceeb, #e0f7fa);
    border-radius: 18px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.35);
  }
</style>
</head>
<body>

<canvas id="game" width="420" height="620"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// ===== GAME STATE =====
let state = "start";
let score = 0;
let highScore = localStorage.getItem("flappyVNHigh") || 0;
let frame = 0;

// ===== CHIM =====
const bird = {
  x: 110,
  y: 300,
  r: 16,
  gravity: 0.55,
  lift: -8.5,
  velocity: 0
};

// ===== á»NG =====
const pipes = [];
const pipeWidth = 60;
const gap = 175;
const speed = 2.2;

// ===== ÄIá»€U KHIá»‚N =====
document.addEventListener("keydown", e => {
  if (e.code === "Space") handleAction();
});
document.addEventListener("click", handleAction);

function handleAction() {
  if (state === "start") {
    state = "play";
  } else if (state === "play") {
    bird.velocity = bird.lift;
  } else if (state === "over") {
    resetGame();
  }
}

// ===== RESET =====
function resetGame() {
  state = "start";
  pipes.length = 0;
  score = 0;
  bird.y = 300;
  bird.velocity = 0;
  frame = 0;
}

// ===== Váº¼ Ná»€N =====
function drawBackground() {
  // MÃ¢y
  ctx.fillStyle = "rgba(255,255,255,0.6)";
  for (let i = 0; i < 3; i++) {
    ctx.beginPath();
    ctx.arc(80 + i * 140 - frame * 0.3 % 500, 90, 25, 0, Math.PI * 2);
    ctx.arc(110 + i * 140 - frame * 0.3 % 500, 80, 30, 0, Math.PI * 2);
    ctx.arc(140 + i * 140 - frame * 0.3 % 500, 90, 25, 0, Math.PI * 2);
    ctx.fill();
  }
}

// ===== Váº¼ CHIM =====
function drawBird() {
  ctx.save();
  ctx.translate(bird.x, bird.y);
  ctx.rotate(bird.velocity * 0.05);

  // ThÃ¢n
  ctx.beginPath();
  ctx.arc(0, 0, bird.r, 0, Math.PI * 2);
  ctx.fillStyle = "#FFD93D";
  ctx.fill();

  // CÃ¡nh
  ctx.beginPath();
  ctx.ellipse(-6, 4, 9, 6, 0, 0, Math.PI * 2);
  ctx.fillStyle = "#F4C430";
  ctx.fill();

  // Máº¯t
  ctx.beginPath();
  ctx.arc(6, -4, 3, 0, Math.PI * 2);
  ctx.fillStyle = "#000";
  ctx.fill();

  // Má»
  ctx.beginPath();
  ctx.moveTo(14, 0);
  ctx.lineTo(24, 5);
  ctx.lineTo(14, 10);
  ctx.closePath();
  ctx.fillStyle = "#FF9800";
  ctx.fill();

  ctx.restore();
}

// ===== Váº¼ á»NG NÆ¯á»šC CHÃ‚N THáº¬T =====
function drawPipes() {
  pipes.forEach(p => {
    // Gradient thÃ¢n á»‘ng
    let g = ctx.createLinearGradient(p.x, 0, p.x + pipeWidth, 0);
    g.addColorStop(0, "#145a32");
    g.addColorStop(0.4, "#2ecc71");
    g.addColorStop(0.6, "#2ecc71");
    g.addColorStop(1, "#145a32");

    ctx.fillStyle = g;

    // á»ng trÃªn
    ctx.fillRect(p.x, 0, pipeWidth, p.top);
    // Miá»‡ng á»‘ng trÃªn
    ctx.fillStyle = "#27ae60";
    ctx.fillRect(p.x - 6, p.top - 18, pipeWidth + 12, 18);

    // á»ng dÆ°á»›i
    ctx.fillStyle = g;
    ctx.fillRect(p.x, p.bottom, pipeWidth, canvas.height);
    // Miá»‡ng á»‘ng dÆ°á»›i
    ctx.fillStyle = "#27ae60";
    ctx.fillRect(p.x - 6, p.bottom, pipeWidth + 12, 18);
  });
}

// ===== UPDATE á»NG =====
function updatePipes() {
  if (frame % 95 === 0) {
    let top = Math.random() * 220 + 70;
    pipes.push({
      x: canvas.width,
      top: top,
      bottom: top + gap,
      passed: false
    });
  }

  pipes.forEach(p => {
    p.x -= speed;

    // Va cháº¡m
    if (
      bird.x + bird.r > p.x &&
      bird.x - bird.r < p.x + pipeWidth &&
      (bird.y - bird.r < p.top || bird.y + bird.r > p.bottom)
    ) {
      gameOver();
    }

    // TÃ­nh Ä‘iá»ƒm
    if (!p.passed && p.x + pipeWidth < bird.x) {
      score++;
      p.passed = true;
    }
  });
}

// ===== GAME OVER =====
function gameOver() {
  state = "over";
  if (score > highScore) {
    highScore = score;
    localStorage.setItem("flappyVNHigh", highScore);
  }
}

// ===== TEXT =====
function drawText() {
  ctx.fillStyle = "#2c3e50";
  ctx.textAlign = "center";

  if (state === "start") {
    ctx.font = "30px Arial";
    ctx.fillText("FLAPPY CHIM VIá»†T NAM", canvas.width / 2, 250);
    ctx.font = "18px Arial";
    ctx.fillText("Nháº¥n Space hoáº·c Click Ä‘á»ƒ chÆ¡i", canvas.width / 2, 300);
    ctx.fillText("ðŸ† Ká»· lá»¥c: " + highScore, canvas.width / 2, 335);
  }

  if (state === "play") {
    ctx.font = "22px Arial";
    ctx.fillText("Äiá»ƒm: " + score, canvas.width / 2, 45);
  }

  if (state === "over") {
    ctx.font = "28px Arial";
    ctx.fillText("GAME OVER", canvas.width / 2, 240);
    ctx.font = "18px Arial";
    ctx.fillText("Äiá»ƒm: " + score, canvas.width / 2, 280);
    ctx.fillText("ðŸ† Ká»· lá»¥c: " + highScore, canvas.width / 2, 310);
    ctx.fillText("Nháº¥n Ä‘á»ƒ chÆ¡i láº¡i", canvas.width / 2, 350);
  }
}

// ===== LOOP =====
function loop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  drawBackground();

  if (state === "play") {
    bird.velocity += bird.gravity;
    bird.y += bird.velocity;

    if (bird.y + bird.r > canvas.height || bird.y - bird.r < 0) {
      gameOver();
    }

    updatePipes();
  }

  drawPipes();
  drawBird();
  drawText();

  frame++;
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>




